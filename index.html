<!DOCTYPE HTML>
<!--Nick Chen made this thing on -->
<html>
	<head>
		<title>
		
		</title>
		<script src="utility.js"></script>
		<script>
			function initialize() {
				displayDiv = document.getElementById("displayDiv");
				statusDiv = document.getElementById("status");
				
				fields = document.getElementsByClassName("field");
				for(i=0;i<fields.length;i++){
					fields[i].content = [];
				}
				
				phase = "flip";
				statusDiv.innerHTML = "Flipping Phase";
				
				deck = [];
				buildDeck();
				shuffle();
			}
			
			function buildDeck(){
				for (i=1;i<14;i++){
					for (s=0;s<4;s++){
					card = {};
					card.cardName = i
					card.cardSuite = s
					card.cardImage = "cardimages/" + i + "-" + s + ".png";
					deck.push(card);
					}
				}
			}
			
			function pickCard(){
				if (phase != "flip"){
					return;
				}
				if (deck.length == 0){
					return;
				}
				
				dealtCard = deck.shift();
				myCard = document.createElement("img");
				myCard.card = dealtCard;
				myCard.addEventListener("click", function(){backToDeck(this);});
				displayDiv.appendChild(myCard);
				
				
				myCard.src = dealtCard.cardImage;
				
				phase = "fill";
				statusDiv.innerHTML = "Filling Phase";
			}
			
			function fieldAdd(fieldNum){
				if (phase != "fill"){
					return;
				}
				
				if(fields[fieldNum].content[0] != null){
					return;
				}
				
				if (dealtCard.cardName == 11){
					if(fieldNum != 4 && fieldNum != 7 && fieldNum !=  8 && fieldNum != 11){
						return;
					}
				}
				
				if (dealtCard.cardName == 12){
					if(fieldNum != 1 && fieldNum != 2 && fieldNum !=  13 && fieldNum != 14){
						return;
					}
				}
				
				if (dealtCard.cardName == 13){
					if(fieldNum != 0 && fieldNum != 3 && fieldNum !=  12 && fieldNum != 15){
						return;
					}
				}
				
				
				displayDiv.removeChild(myCard);
				fields[fieldNum].content.push(dealtCard);
				fields[fieldNum].src = dealtCard.cardImage;
//add event listener to detect remove phase later				
				
				checkForEmpty();
			}
			
			function shuffle(){
				if (deck.length == 0 ){
					return;
				}
				tempDeck = [];
				l = deck.length;
				for (i=0;i<l;i++){
					randomIdx = getRandomNumber(0,deck.length-1);
					tempDeck.push(deck.splice(randomIdx,1)[0]);
				}
				deck = tempDeck;
			}
			
			function checkForEmpty(){
				for(i=0;i<fields.length;i++){
					if(fields[i].content[0] == null){
						phase = "flip";	
						statusDiv.innerHTML = "Flipping Phase";					
						return;
					}
				}
				phase = "remove";
				statusDiv.innerHTML = "Removing Phase";				
			}
		</script>
		<style>
			body{
				text-align:center;
			}
		</style>
	</head>
	<body onload="initialize();">
		<p>
			<p>
				<img class="field" src="cardimages/blank.png" id="field1" onclick="fieldAdd(0)">
				<img class="field" src="cardimages/blank.png" id="field2" onclick="fieldAdd(1)">
				<img class="field" src="cardimages/blank.png" id="field3" onclick="fieldAdd(2)">
				<img class="field" src="cardimages/blank.png" id="field4" onclick="fieldAdd(3)">
			</p>
			<p>
				<img class="field" src="cardimages/blank.png" id="field5" onclick="fieldAdd(4)">
				<img class="field" src="cardimages/blank.png" id="field6" onclick="fieldAdd(5)">
				<img class="field" src="cardimages/blank.png" id="field7" onclick="fieldAdd(6)">
				<img class="field" src="cardimages/blank.png" id="field8" onclick="fieldAdd(7)">
			</p>
			<p>
				<img class="field" src="cardimages/blank.png" id="field9" onclick="fieldAdd(8)">
				<img class="field" src="cardimages/blank.png" id="field10" onclick="fieldAdd(9)">
				<img class="field" src="cardimages/blank.png" id="field11" onclick="fieldAdd(10)">
				<img class="field" src="cardimages/blank.png" id="field12" onclick="fieldAdd(11)">		
			</p>
			<p>
				<img class="field" src="cardimages/blank.png" id="field13" onclick="fieldAdd(12)">
				<img class="field" src="cardimages/blank.png" id="field14" onclick="fieldAdd(13)">
				<img class="field" src="cardimages/blank.png" id="field15" onclick="fieldAdd(14)">
				<img class="field" src="cardimages/blank.png" id="field16" onclick="fieldAdd(15)">			
			</p>
		</p>
		
		<img onclick="pickCard();" src="cardimages/back-red-75-1.png">
		<div id="status"></div>
		<div id="displayDiv"></div>
	</body>
</html>